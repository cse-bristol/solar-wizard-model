from albion_models.lidar.grid_ref import os_grid_ref_to_en, os_grid_ref_to_wkt
from albion_models.test.test_funcs import ParameterisedTestCase


class GridRefTest(ParameterisedTestCase):

    def test_os_grid_ref_to_en(self):
        self.parameterised_test([
            # Test mapping of 1st letter:
            ('SV0000', (0,      0,       1000)),
            ('TV0000', (500000, 0,       1000)),
            ('NV0000', (0,      500000,  1000)),
            ('OV0000', (500000, 500000,  1000)),
            ('HV0000', (0,      1000000, 1000)),

            # Test mapping of 2nd letter:
            ('SA0000', (0,      400000, 1000)),
            ('SB0000', (100000, 400000, 1000)),
            ('SC0000', (200000, 400000, 1000)),
            ('SD0000', (300000, 400000, 1000)),
            ('SE0000', (400000, 400000, 1000)),
            ('SF0000', (0,      300000, 1000)),
            ('SG0000', (100000, 300000, 1000)),
            ('SH0000', (200000, 300000, 1000)),
            ('SJ0000', (300000, 300000, 1000)),
            ('SK0000', (400000, 300000, 1000)),
            ('SL0000', (0,      200000, 1000)),
            ('SM0000', (100000, 200000, 1000)),
            ('SN0000', (200000, 200000, 1000)),
            ('SO0000', (300000, 200000, 1000)),
            ('SP0000', (400000, 200000, 1000)),
            ('SQ0000', (0,      100000, 1000)),
            ('SR0000', (100000, 100000, 1000)),
            ('SS0000', (200000, 100000, 1000)),
            ('ST0000', (300000, 100000, 1000)),
            ('SU0000', (400000, 100000, 1000)),
            ('SV0000', (0,      0, 1000)),
            ('SW0000', (100000, 0, 1000)),
            ('SX0000', (200000, 0, 1000)),
            ('SY0000', (300000, 0, 1000)),
            ('SZ0000', (400000, 0, 1000)),

            # Test mapping of rest:
            ('SV0101', (1000, 1000, 1000)),
            ('SV0322', (3000, 22000, 1000)),
            ('SV2322', (23000, 22000, 1000)),
            ('SV12NE', (12500, 22500, 2500)),
            ('sv12ne', (12500, 22500, 2500)),
        ], os_grid_ref_to_en)

    def test_os_grid_ref_to_wkt(self):
        self.parameterised_test([
            ('SV12NE', 'POLYGON((12500 22500, 12500 25000, 15000 25000, 15000 22500, 12500 22500))'),
            ('SV0101', 'POLYGON((1000 1000, 1000 2000, 2000 2000, 2000 1000, 1000 1000))'),
        ], os_grid_ref_to_wkt)
